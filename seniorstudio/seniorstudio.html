<!doctype html>
<html>
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"/>
    <title>Studio Art Web App</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Abel|Homemade+Apple" rel="stylesheet">
</head>

<body>
	<h2 class="text-center" style="font-family: 'Homemade Apple', cursive; color: #000000;">Test 2.6</h2>
	<p class="text-center" style="font-family: 'Abel', sans-serif; color: #BBBBBB; padding; 32px;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis vitae pellentesque sapien. Morbi ullamcorper enim malesuada sapien cursus, quis tristique nunc volutpat. </p>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

	<style>
	  .thumb {
	    width: 100%;
	    border: none;
	    margin: 10px 5px 0 0;
	  }

	  .overlay {
	  	width: 100%;
	  	border: none;
	    margin: 10px 5px 0 0;
    	position: absolute;   
    	left:0;
    	top: 0;
    	z-index: 999;
	  }

	  .container {
 		position: relative;   
	  }
	</style>

	<!-- <input type="file" id="files" name="files[]" multiple /> -->

	<label class="btn btn-block btn-default" style="font-family: 'Abel', sans-serif; margin: 16px;">
           Take Picture <input type="file" id="files" accept="image/*" name="files[]" style="display: none;">
    </label>

	<div class="container"> 
		<p><output id="list"></output></p>
	</div>

	<canvas id="myCanvas" width="960" height="1280"></canvas>

	<script>
	  function handleFileSelect(evt) {
	    var files = evt.target.files; // FileList object

	    // Loop through the FileList and render image files as thumbnails.
	    for (var i = 0, f; f = files[i]; i++) {

	      // Only process image files.
	      if (!f.type.match('image.*')) {
	        continue;
	      }

	      var reader = new FileReader();

	    //TODO: have it save photo
	    reader.onload = (function(theFile) {
	        return function(e) {
	          // Render thumbnail.
	          var span = document.createElement('span');
	          var c=document.getElementById("myCanvas");
				var ctx=c.getContext("2d");
				var imageObj1 = new Image();
				var imageObj2 = new Image();
				imageObj1.src = e.target.result;
				imageObj1.onload = function() {
				   ctx.drawImage(imageObj1, 0, 0, 960, 1280);
				   imageObj2.src = "img/LittleOrangeHands.png";
				   imageObj2.onload = function() {
				      ctx.drawImage(imageObj2, 0, 0, 960, 1280);
				      var img = new Image();
					  img.setAttribute('crossOrigin', 'anonymous');
				      img = c.toDataURL("img/merged.png");
				      span.innerHTML = ['<img class="thumb" src="' + img + '" width="960" height="1280"/>'].join('');
				      document.getElementById('list').replaceWith(span);
				   }
				};         
	        };
	      })(f);
	    

	      // Closure to capture the file information.
	      // reader.onload = (function(theFile) {
	      //   return function(e) {
	      //     // Render thumbnail.
	      //     var span = document.createElement('span');
	      //     span.innerHTML = ['<img class="thumb" src="', e.target.result,
	      //                       '" title="', escape(theFile.name),'"/><img src="img/LittleOrangeHands.png" class="overlay"/>'].join('');
	      //     document.getElementById('list').replaceWith(span);
	      //   };
	      // })(f);

	      // Read in the image file as a data URL.
	      reader.readAsDataURL(f);
	    }
	  }

	  document.getElementById('files').addEventListener('change', handleFileSelect, false);

	</script>


</body>
</html>